import{c as $,ac as p,f as T,j as e,aa as h,am as W,T as r,an as X,ao as H,e as J,I as K,af as C,ap as A,ad as Q,S as U,aq as Y,ar as Z,as as ee}from"./index-Ba5j3L-Q.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],se=$("ellipsis",ae);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],te=$("pencil",ne);function ie({defaultLimit:a=10,defaultPage:n=1}={}){const[c,t]=p.useState(n),[o]=p.useState(a),l=p.useCallback(u=>{t(u)},[]);return{currentPage:c,limit:o,onPageChange:l}}function le({queryHook:a,createHook:n,removeHook:c,updateHook:t,getTransformedData:o,methods:l}){const{control:u,watch:j}=T({defaultValues:{inputValue:""}}),[s,i]=p.useState(!1),[f,d]=p.useState(null),[m,g]=p.useState(null),k=j("inputValue"),{reset:b,getValues:N,handleSubmit:L}=l,[E]=c(),[I,{isLoading:v}]=n(),[S,{isLoading:y}]=t(),z=ie(),{data:M,isLoading:q,isFetching:B}=a({page:z.currentPage,limit:z.limit,query:k});p.useEffect(()=>{s||(b?.(),g(null))},[s,b]);function F(x){g(x),b?.(x),i(!0)}async function G(){const x=o?o():N?.();x&&(m?await S({...m,...x}):await I(x),i(!1))}async function O(x,D){if(x==="edit"){const _=M?.data?.find(R=>R.id===D);_&&F(_)}else d(D),await E({id:D}),d(null)}return{data:M,pagintaionData:z,isLoading:q,isFetching:B,editLoading:v||y,editableItem:m,setEditableItem:g,open:s,setOpen:i,setEditItem:F,submitAction:G,actions:O,loadDeletedId:f,inputControl:u,inputValue:k}}function ce({className:a,...n}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:h("mx-auto flex w-full justify-center",a),...n})}function P({className:a,...n}){return e.jsx("ul",{"data-slot":"pagination-content ",className:h("flex flex-row items-center gap-1",a),...n})}function w({...a}){return e.jsx("li",{"data-slot":"pagination-item",...a})}function V({className:a,isActive:n,size:c="icon",...t}){return e.jsx("a",{"aria-current":n?"page":void 0,"data-slot":"pagination-link","data-active":n,className:h(X({variant:n?"secondary":"outline",size:c}),a),...t})}function oe({className:a,...n}){return e.jsxs(V,{"aria-label":"Go to previous page",size:"default",className:h("gap-1 px-2.5 sm:pl-2.5",a),...n,children:[e.jsx(W,{}),e.jsx(r,{color:"brand-100",className:"hidden sm:block",children:"Прошлая"})]})}function re({className:a,...n}){return e.jsxs(V,{"aria-label":"Go to next page",size:"default",className:h("gap-1 px-2.5 sm:pr-2.5",a),...n,children:[e.jsx(r,{color:"brand-100",className:"hidden sm:block",children:"Следующая"}),e.jsx(H,{})]})}function de({className:a,...n}){return e.jsxs("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:h("flex size-9 items-center justify-center",a),...n,children:[e.jsx(se,{className:"size-4 text-brand-200"}),e.jsx(r,{color:"brand-100",className:"sr-only",children:"Больше страниц"})]})}const xe=({currentPage:a,total:n,limit:c,onPageChange:t,className:o})=>{const l=Math.max(1,Math.ceil(n/c)),j=(()=>{const s=[];if(l<=5)for(let i=1;i<=l;i++)s.push(i);else{s.push(1),a>3&&s.push("ellipsis");const i=Math.max(2,a-1),f=Math.min(l-1,a+1);for(let d=i;d<=f;d++)s.push(d);a<l-2&&s.push("ellipsis"),s.push(l)}return s})();return e.jsxs(ce,{className:J("flex items-center justify-between",o),children:[e.jsx(P,{children:e.jsx(w,{children:e.jsx(oe,{href:"#",onClick:s=>{s.preventDefault(),a>1&&t(a-1)},"aria-disabled":a===1})})}),e.jsx(P,{className:"justify-center flex-1",children:j.map((s,i)=>s==="ellipsis"?e.jsx(w,{children:e.jsx(de,{})},`e-${i}`):e.jsx(w,{children:e.jsx(V,{href:"#",isActive:s===a,onClick:f=>{f.preventDefault(),s!==a&&t(s)},children:s})},s))}),e.jsx(P,{children:e.jsx(w,{children:e.jsx(re,{href:"#",onClick:s=>{s.preventDefault(),a<l&&t(a+1)},"aria-disabled":a===l})})})]})},me=({children:a,queryHook:n,createHook:c,updateHook:t,removeHook:o,mapData:l,methods:u,contentName:j})=>{const{open:s,setOpen:i,actions:f,submitAction:d,pagintaionData:m,loadDeletedId:g,inputControl:k,editLoading:b,data:N,isLoading:L,isFetching:E}=le({queryHook:n,createHook:c,updateHook:t,removeHook:o,methods:u}),{formState:{isDirty:I}}=u,v=l(N?.data),S=E&&!L;return e.jsxs("div",{className:"flex flex-col relative bg-brand-3 border-1 rounded-md border-brand-300 bg-brand-500 flex-1 h-full p-4 gap-3 min-h-0",children:[e.jsxs("div",{className:"flex flex-col flex-1 h-full gap-3",children:[e.jsxs("div",{className:"flex gap-2 h-[36px]",children:[e.jsx(K,{placeholder:"Поиск по названию...",className:"flex-4",control:k,name:"inputValue"}),e.jsx(C,{variant:"secondary",className:"min-w-[160px]",onClick:()=>i(!0),children:"Создать"})]}),e.jsx("div",{className:"flex-1 min-h-0 h-full overflow-y-auto flex justify-center overscroll-contain",children:L?e.jsx(A,{className:"m-auto"}):Array.isArray(v)?v.length===0?e.jsx(r,{className:"m-auto",children:"Данных нет"}):e.jsx("div",{className:"flex flex-col w-full gap-3",children:v.map(y=>e.jsx(ue,{isLoading:y.id===g,actions:f,...y},y.id))}):e.jsx(r,{className:"m-auto",children:"Произошла ошибка"})}),S&&e.jsx("div",{className:"absolute bottom-0 left-0 p-5",children:e.jsx(A,{className:"!text-brand-100"})}),e.jsx("div",{className:"mt-auto",children:N?.meta&&e.jsx(xe,{onPageChange:m.onPageChange,className:"mt-auto",total:N?.meta.total,limit:m.limit,currentPage:m.currentPage})})]}),e.jsx(Q,{contentClassname:"w-[95%] h-[95%] max-h-[900px] block !max-w-[1600px] border-none p-0 bg-transparent",setOpen:i,open:s,children:e.jsx(U,{className:"flex h-full max-h-full",children:e.jsxs("div",{className:"flex-1 flex flex-col bg-brand-400 border-1 rounded-md border-brand-300 p-4",children:[e.jsxs("div",{className:"flex justify-between gap-4 items-center pb-2",children:[e.jsxs(r,{size:"2xl",weight:"bold",color:"brand-100",children:[j,e.jsx(r,{as:"span",size:"lg",color:"brand-100",className:"ml-2",children:"- Изменение / Создание"})]}),I&&e.jsx(Y,{className:"!bg-blue-500",children:"Изменения не сохранены"})]}),e.jsx(Z,{spacing:"empty"}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2 flex flex-col gap-4",children:a}),e.jsx("div",{className:"flex gap-2 pt-2 justify-end",children:e.jsx(C,{isLoading:b,onClick:d,variant:"success",children:"Сохранить"})})]})})})]})},ue=({isLoading:a,title:n,description:c,actions:t,id:o})=>e.jsxs("div",{className:"flex justify-between gap-2 border-1 items-start border-brand-200 p-3 rounded-md",children:[e.jsxs("div",{children:[e.jsxs(r,{size:"xl",children:["Название:"," ",n]}),e.jsxs(r,{children:[" ","Описание:"," ",c]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{disabled:a,onClick:()=>t("edit",o),children:e.jsx(te,{})}),e.jsx(C,{isLoading:a,onClick:()=>t("delete",o),children:e.jsx(ee,{})})]})]});export{me as E};
